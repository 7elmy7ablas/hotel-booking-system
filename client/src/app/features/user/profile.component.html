<div class="profile-container">
  <!-- Header -->
  <section class="header-section">
    <div class="container">
      <h1>My Profile</h1>
      <p class="subtitle">Manage your account settings</p>
    </div>
  </section>

  <!-- Content Section -->
  <section class="content-section">
    <div class="container">
      <!-- Loading State -->
      <div *ngIf="isLoading" class="loading-state">
        <div class="skeleton skeleton-card"></div>
      </div>

      <!-- Profile Content -->
      <div *ngIf="!isLoading && user" class="profile-content">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
          <button 
            class="tab-button"
            [class.active]="activeTab === 'view'"
            (click)="switchTab('view')"
          >
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
            View Profile
          </button>
          <button 
            class="tab-button"
            [class.active]="activeTab === 'edit'"
            (click)="switchTab('edit')"
          >
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
            Edit Profile
          </button>
          <button 
            class="tab-button"
            [class.active]="activeTab === 'password'"
            (click)="switchTab('password')"
          >
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
            Change Password
          </button>
        </div>

        <!-- Tab Content -->
        <div class="tab-content">
          <!-- View Tab -->
          <div *ngIf="activeTab === 'view'" class="profile-card">
            <div class="profile-header">
              <div class="avatar">
                <span>{{ user.fullName.charAt(0).toUpperCase() }}</span>
              </div>
              <div class="user-info">
                <h2>{{ user.fullName }}</h2>
                <p class="user-role">{{ user.role }}</p>
              </div>
            </div>

            <div class="profile-details">
              <div class="detail-item">
                <span class="detail-label">Email Address</span>
                <span class="detail-value">{{ user.email }}</span>
              </div>

              <div class="detail-item">
                <span class="detail-label">Full Name</span>
                <span class="detail-value">{{ user.fullName }}</span>
              </div>

              <div class="detail-item">
                <span class="detail-label">Phone Number</span>
                <span class="detail-value">{{ user.phoneNumber || 'Not provided' }}</span>
              </div>

              <div class="detail-item">
                <span class="detail-label">Account Role</span>
                <span class="detail-value">{{ user.role }}</span>
              </div>

              <div class="detail-item">
                <span class="detail-label">Member Since</span>
                <span class="detail-value">{{ formatDate(user.createdAt) }}</span>
              </div>
            </div>

            <div class="profile-actions">
              <button (click)="switchTab('edit')" class="btn btn-primary">
                Edit Profile
              </button>
              <button (click)="logout()" class="btn btn-outline">
                Logout
              </button>
            </div>
          </div>

          <!-- Edit Tab -->
          <div *ngIf="activeTab === 'edit'" class="profile-card">
            <h3>Edit Profile Information</h3>
            <p class="card-subtitle">Update your personal details</p>

            <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="profile-form">
              <div class="form-group">
                <label class="form-label">Full Name *</label>
                <input 
                  type="text" 
                  formControlName="fullName"
                  placeholder="Enter your full name"
                  class="form-input"
                  [class.form-input-error]="profileForm.get('fullName')?.invalid && profileForm.get('fullName')?.touched"
                />
                <span 
                  *ngIf="profileForm.get('fullName')?.invalid && profileForm.get('fullName')?.touched"
                  class="form-error"
                >
                  Full name is required (minimum 2 characters)
                </span>
              </div>

              <div class="form-group">
                <label class="form-label">Email Address</label>
                <input 
                  type="email" 
                  [value]="user.email"
                  disabled
                  class="form-input"
                />
                <span class="form-hint">Email cannot be changed</span>
              </div>

              <div class="form-group">
                <label class="form-label">Phone Number</label>
                <input 
                  type="tel" 
                  formControlName="phoneNumber"
                  placeholder="+1 (555) 000-0000"
                  class="form-input"
                  [class.form-input-error]="profileForm.get('phoneNumber')?.invalid && profileForm.get('phoneNumber')?.touched"
                />
                <span 
                  *ngIf="profileForm.get('phoneNumber')?.invalid && profileForm.get('phoneNumber')?.touched"
                  class="form-error"
                >
                  Please enter a valid phone number
                </span>
              </div>

              <div *ngIf="successMessage" class="alert alert-success">
                {{ successMessage }}
              </div>

              <div *ngIf="errorMessage" class="alert alert-error">
                {{ errorMessage }}
              </div>

              <div class="form-actions">
                <button 
                  type="submit" 
                  class="btn btn-primary"
                  [disabled]="isSaving || profileForm.invalid"
                >
                  {{ isSaving ? 'Saving...' : 'Save Changes' }}
                </button>
                <button 
                  type="button" 
                  class="btn btn-outline"
                  (click)="switchTab('view')"
                  [disabled]="isSaving"
                >
                  Cancel
                </button>
              </div>
            </form>
          </div>

          <!-- Password Tab -->
          <div *ngIf="activeTab === 'password'" class="profile-card">
            <h3>Change Password</h3>
            <p class="card-subtitle">Update your account password</p>

            <form [formGroup]="passwordForm" (ngSubmit)="changePassword()" class="profile-form">
              <div class="form-group">
                <label class="form-label">Current Password *</label>
                <input 
                  type="password" 
                  formControlName="currentPassword"
                  placeholder="Enter current password"
                  class="form-input"
                  [class.form-input-error]="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched"
                />
                <span 
                  *ngIf="passwordForm.get('currentPassword')?.invalid && passwordForm.get('currentPassword')?.touched"
                  class="form-error"
                >
                  Current password is required
                </span>
              </div>

              <div class="form-group">
                <label class="form-label">New Password *</label>
                <input 
                  type="password" 
                  formControlName="newPassword"
                  placeholder="Enter new password"
                  class="form-input"
                  [class.form-input-error]="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched"
                />
                <span 
                  *ngIf="passwordForm.get('newPassword')?.invalid && passwordForm.get('newPassword')?.touched"
                  class="form-error"
                >
                  Password must be at least 8 characters
                </span>
              </div>

              <div class="form-group">
                <label class="form-label">Confirm New Password *</label>
                <input 
                  type="password" 
                  formControlName="confirmPassword"
                  placeholder="Confirm new password"
                  class="form-input"
                  [class.form-input-error]="passwordForm.get('confirmPassword')?.invalid && passwordForm.get('confirmPassword')?.touched"
                />
                <span 
                  *ngIf="passwordForm.get('confirmPassword')?.hasError('passwordMismatch') && passwordForm.get('confirmPassword')?.touched"
                  class="form-error"
                >
                  Passwords do not match
                </span>
              </div>

              <div *ngIf="successMessage" class="alert alert-success">
                {{ successMessage }}
              </div>

              <div *ngIf="errorMessage" class="alert alert-error">
                {{ errorMessage }}
              </div>

              <div class="form-actions">
                <button 
                  type="submit" 
                  class="btn btn-primary"
                  [disabled]="isSaving || passwordForm.invalid"
                >
                  {{ isSaving ? 'Changing...' : 'Change Password' }}
                </button>
                <button 
                  type="button" 
                  class="btn btn-outline"
                  (click)="switchTab('view')"
                  [disabled]="isSaving"
                >
                  Cancel
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
